(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{436:function(e,s,a){"use strict";a.r(s);var n=a(57),t=Object(n.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"å‰è¨€"}},[e._v("å‰è¨€")]),e._v(" "),a("p",[e._v("å…¨æ–¹ä½çš„ä»‹ç»å¦‚ä½•ä½¿ç”¨"),a("code",[e._v("JEST")]),e._v("æµ‹è¯•ä¸€ä¸ªVUEç»„ä»¶ã€‚"),a("br"),e._v("\nï¼ˆå¦‚æœä¸çŸ¥é“æ€ä¹ˆå¼€å§‹"),a("code",[e._v("VUE")]),e._v("å•å…ƒæµ‹è¯•çš„åŒå­¦ä»¬ï¼Œè¯·æŸ¥çœ‹ä¹‹å‰çš„æ–‡ç« "),a("a",{attrs:{href:"https://juejin.cn/post/6906295144505409549",target:"_blank",rel:"noopener noreferrer"}},[e._v("VUEå•å…ƒæµ‹è¯•--å¼€å¯æµ‹è¯•ä¹‹æ—…"),a("OutboundLink")],1),e._v("ï¼‰")]),e._v(" "),a("p",[e._v("ç€é‡ä»‹ç»åœ¨ä½¿ç”¨"),a("code",[e._v("Vue.extend")]),e._v("åˆ›å»ºæ„é€ å‡½æ•°çš„å½¢å¼æ³¨å†Œçš„ç»„ä»¶ï¼ŒåŒ…æ‹¬ï¼š")]),e._v(" "),a("ul",[a("li",[e._v("æµ‹è¯•å®šæ—¶å™¨å‡½æ•°")]),e._v(" "),a("li",[e._v("æµ‹è¯•"),a("code",[e._v("HTTP")]),e._v("è¯·æ±‚")]),e._v(" "),a("li",[e._v("æµ‹è¯•äº‹ä»¶\nç­‰è¿™å‡ ä¸ªéƒ¨åˆ†çš„ä»‹ç»")])]),e._v(" "),a("p",[e._v("ä»£ç åœ¨"),a("a",{attrs:{href:"https://github.com/zhangwinwin/FEBlog/tree/master/unitest",target:"_blank",rel:"noopener noreferrer"}},[e._v("github"),a("OutboundLink")],1),e._v("æ¬¢è¿ç‚¹èµğŸ‘")]),e._v(" "),a("h2",{attrs:{id:"æµ‹è¯•ç»„ä»¶"}},[e._v("æµ‹è¯•ç»„ä»¶")]),e._v(" "),a("p",[e._v("æµ‹è¯•ç»„ä»¶ï¼Œå…¶å®å°±æ˜¯æµ‹è¯•ç»„ä»¶çš„æ–¹æ³•ä»¥åŠæ–¹æ³•æ‰€ä¾èµ–çš„æ¨¡å—ã€‚"),a("br"),e._v("\næµ‹è¯•ç»„ä»¶æ–¹æ³•å¾ˆç®€å•ï¼šè°ƒç”¨ç»„ä»¶æ–¹æ³•å¹¶æ–­è¨€æ–¹æ³•èƒ½ç”¨æ­£ç¡®åœ°å½±å“äº†ç»„ä»¶çš„è¾“å‡ºå³å¯ã€‚")]),e._v(" "),a("p",[e._v("ä»ä¸€ä¸ªä¾‹å­å‡ºå‘ï¼Œæµ‹è¯•ä¸€ä¸ªè¿›åº¦æ¡ç»„ä»¶")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('<template>\n  <div class="Progress-Bar" :class="{hidden: hidden}">\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \'ProgressBar\',\n  data () {\n    return {\n      hidden: true\n    }\n  },\n  methods: {\n    start () {\n      this.hidden = false;\n    },\n    finally () {\n      this.hidden = true;\n    }\n  },\n}\n<\/script>\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br"),a("span",{staticClass:"line-number"},[e._v("19")]),a("br"),a("span",{staticClass:"line-number"},[e._v("20")]),a("br"),a("span",{staticClass:"line-number"},[e._v("21")]),a("br"),a("span",{staticClass:"line-number"},[e._v("22")]),a("br"),a("span",{staticClass:"line-number"},[e._v("23")]),a("br")])]),a("p",[e._v("ä»£ç ä¸€ç›®äº†ç„¶ï¼Œå½“è°ƒç”¨"),a("code",[e._v("start")]),e._v("æ–¹æ³•æ—¶ï¼Œåº”è¯¥å±•ç¤ºè¿›åº¦æ¡ï¼›å½“è°ƒç”¨"),a("code",[e._v("finally")]),e._v("æ–¹æ³•æ—¶ï¼Œåº”è¯¥å±è”½è¿›åº¦æ¡ã€‚")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("import { shallowMount } from '@vue/test-utils';\nimport ProgressBar from '@/views/ProgressBar.vue';\n\ndescribe('test progress', () => {\n  it('when start is clicked, show the progressBar', () => {\n    const wrapper = shallowMount(ProgressBar);\n    expect(wrapper.classes()).toContain('hidden');\n    wrapper.vm.start();\n    wrapper.vm.finally();\n    expect(wrapper.classes()).toContain('hidden');\n  })\n})\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br")])]),a("p",[e._v("è¿è¡Œ"),a("code",[e._v("yarn test:unit")]),e._v("æ—¶ï¼Œæµ‹è¯•é€šè¿‡ã€‚")]),e._v(" "),a("p",[e._v("è¿™æ˜¯ç®€å•çš„ç»„ä»¶æµ‹è¯•ã€‚")]),e._v(" "),a("h3",{attrs:{id:"vueå®ä¾‹æ·»åŠ å±æ€§"}},[e._v("Vueå®ä¾‹æ·»åŠ å±æ€§")]),e._v(" "),a("p",[e._v("äº‹å®ä¸Šè¿˜æœ‰ä¸€ç§éå¸¸å¸¸è§çš„ç»„ä»¶æ¨¡å¼ï¼Œå°±æ˜¯å¾€"),a("code",[e._v("Vue")]),e._v("å®ä¾‹æ·»åŠ å±æ€§ã€‚åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ä¹Ÿä»‹ç»è¿‡ï¼Œç”¨è¿™"),a("a",{attrs:{href:"https://juejin.cn/post/6893303835251441677",target:"_blank",rel:"noopener noreferrer"}},[e._v("VUEçš„â€œåŠ¨æ€â€æ¡ˆä¾‹"),a("OutboundLink")],1),e._v("ä»‹ç»çš„ç»„ä»¶æ¥åšä¾‹å­ï¼Œç»„ä»¶çš„å…·ä½“å¼€å‘å°±ä¸å¤šä½œä»‹ç»äº†ï¼Œä»£ç åœ¨ä»£ç åœ¨"),a("a",{attrs:{href:"https://github.com/zhangwinwin/FEBlog/tree/master/unitest",target:"_blank",rel:"noopener noreferrer"}},[e._v("github"),a("OutboundLink")],1),e._v("ä¸­ã€‚"),a("br"),e._v("\nï¼ˆè¿›å…¥åˆ°"),a("code",[e._v("unitest")]),e._v("æ–‡ä»¶å¤¹ä¸­ï¼Œè¿è¡Œ"),a("code",[e._v("yarn serve")]),e._v("ã€‚ï¼‰")]),e._v(" "),a("p",[e._v("åŠŸèƒ½ï¼šç‚¹å‡»æŒ‰é’®è§¦å‘"),a("code",[e._v("handleCheck")]),e._v("äº‹ä»¶ï¼Œå¼¹å‡º"),a("code",[e._v("alarm")]),e._v("å¼¹çª—ï¼Œå¼¹çª—"),a("code",[e._v("id")]),e._v("å°±æ˜¯åœ¨"),a("code",[e._v("primaryId")]),e._v("åŸºç¡€ä¸Šå¢åŠ 1ã€‚"),a("br"),e._v("\næµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹ï¼š")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("describe('test alarm', () => {\n  it('when handleCheck is clicked, show the alarm', () => {\n    const wrapper = shallowMount(Home);\n    const count = wrapper.vm.primaryId;\n    wrapper.vm.handleCheck();\n    const newCount = wrapper.vm.primaryId;\n    expect(newCount).toBe(count + 1)\n  })\n})\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br")])]),a("p",[e._v("è¿è¡Œ"),a("code",[e._v("yarn test:uni")]),e._v("æ—¶ä¼šå‘ç”Ÿé”™è¯¯\n"),a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/512eb096fd1844b49c8900c436e0f67e~tplv-k3u1fbpfcp-watermark.image",alt:""}})]),e._v(" "),a("p",[e._v("è¿™æ˜¯å› ä¸ºåœ¨æµ‹è¯•ä¸­ç›´æ¥æŒ‚è½½äº†ç»„ä»¶ï¼Œè€Œè¿™ä¸ªç»„ä»¶å®ä¾‹æ˜¯ä½¿ç”¨"),a("code",[e._v("Vue.extend")]),e._v("å‡½æ•°åˆ›å»ºçš„ï¼Œå¹¶åœ¨"),a("code",[e._v("main.js")]),e._v("å¼•å…¥å’Œæ·»åŠ åˆ°"),a("code",[e._v("Vue")]),e._v("çš„åŸå‹ä¸­çš„ã€‚æ¢è€Œè¨€ä¹‹ï¼Œ"),a("code",[e._v("main.js")]),e._v("å¹¶æ²¡æœ‰è¢«æ‰§è¡Œï¼Œè¿™ä¸ªç»„ä»¶å°±æ²¡æœ‰è¢«åˆ›å»ºï¼Œ"),a("code",[e._v("$alarm")]),e._v("å±æ€§å°±æ°¸è¿œä¸ä¼šè¢«æ·»åŠ ã€‚\n"),a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/696f8ef28fe34eeb940d479d2a28e1a1~tplv-k3u1fbpfcp-watermark.image",alt:""}})]),e._v(" "),a("p",[e._v("è¿™æ—¶éœ€è¦åœ¨åŠ è½½ç»„ä»¶åˆ°æµ‹è¯•ä¹‹å‰å…ˆä¸º"),a("code",[e._v("Vue")]),e._v("å®ä¾‹æ·»åŠ å±æ€§ã€‚å¯ä»¥ä½¿ç”¨"),a("code",[e._v("mocks")]),e._v("æ¥å®ç°ã€‚")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("shallowMount(Home, {\n  mocks: {\n    $alarm: () => {}\n  }\n})\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])]),a("p",[e._v("å†æ¬¡è¿è¡Œ"),a("code",[e._v("yarn test:uni")]),e._v("æ—¶å°±å®Œç¾çš„é€šè¿‡äº†ã€‚")]),e._v(" "),a("h3",{attrs:{id:"æµ‹è¯•å®šæ—¶å™¨å‡½æ•°"}},[e._v("æµ‹è¯•å®šæ—¶å™¨å‡½æ•°")]),e._v(" "),a("p",[e._v("å®šæ—¶å™¨å‡½æ•°åŒ…æ‹¬"),a("code",[e._v("JavaScript")]),e._v("å¼‚æ­¥å‡½æ•°éƒ½æ˜¯å‰ç«¯ä¸­å¸¸è§çš„åŠŸèƒ½ï¼Œæ‰€ä»¥éƒ½éœ€è¦æµ‹è¯•å¯¹åº”çš„ä»£ç ã€‚ä½†è‚¯å®šä¸æ˜¯ç­‰å¾…å®šæ—¶å™¨å‡½æ•°èµ°å®Œï¼Œéœ€è¦ä½¿ç”¨"),a("code",[e._v("Jest.useFakeTimers")]),e._v("æ›¿æ¢å…¨å±€å®šæ—¶å™¨å‡½æ•°ï¼Œæ›¿æ¢åå¯ä»¥ä½¿ç”¨"),a("code",[e._v("runTimersToTime")]),e._v("æ¨è¿›æ—¶é—´ã€‚")]),e._v(" "),a("h4",{attrs:{id:"æµ‹è¯•settimeout"}},[e._v("æµ‹è¯•setTimeout")]),e._v(" "),a("p",[e._v("åŠŸèƒ½ï¼š"),a("code",[e._v("handleCheck")]),e._v("äº‹ä»¶è§¦å‘åï¼Œä¼šå°†"),a("code",[e._v("alarm")]),e._v("ç»„ä»¶"),a("code",[e._v("id unshift")]),e._v("åˆ°"),a("code",[e._v("idList")]),e._v("æ•°ç»„ä¸­ï¼Œå¼¹å‡º3ç§’åç»„ä»¶å°±ä¼šè¢«é”€æ¯ï¼Œ"),a("code",[e._v("idList")]),e._v("ä¹Ÿä¼šå°†å…¶"),a("code",[e._v("id")]),e._v("ç»™åˆ é™¤æ‰ã€‚"),a("br"),e._v("\næµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹ï¼š")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("it('when handleCheck is clicked, 3second later alarm would be disappeared', () => {\n  // æµ‹è¯•ä¹‹å‰ï¼Œæ›¿æ¢å…¨å±€å®šæ—¶å‡½æ•°\n  jest.useFakeTimers();\n  const wrapper = shallowMount(Home, {\n    mocks: {\n      $alarm: () => {}\n    }\n  });\n  wrapper.vm.handleCheck();\n  expect(wrapper.vm.idList.length).toBe(1);\n  // å°†æ—¶é—´æ¨è¿›3000æ¯«ç§’\n  jest.runTimersToTime(3000);\n  expect(wrapper.vm.idList.length).toBe(0);\n})\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br")])]),a("h4",{attrs:{id:"æµ‹è¯•cleartimeout"}},[e._v("æµ‹è¯•clearTimeout")]),e._v(" "),a("p",[e._v("åŠŸèƒ½ï¼šå½“"),a("code",[e._v("alarm")]),e._v("å¼¹çª—è¶…è¿‡ä¸€ä¸ªçš„æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨"),a("code",[e._v("clearTimeout")]),e._v("é”€æ¯å‰ä¸€ä¸ªçš„"),a("code",[e._v("timer")]),e._v("ã€‚è¿™æ—¶å°±è¦ç›‘å¬"),a("code",[e._v("clearTimeout")]),e._v("æ˜¯å¦è¢«è°ƒç”¨ã€‚")]),e._v(" "),a("p",[e._v("ä½¿ç”¨"),a("code",[e._v("Jest.spyOn")]),e._v("å‡½æ•°åˆ›å»ºä¸€ä¸ª"),a("code",[e._v("spy")]),e._v("ï¼Œå¯ä»¥ä½¿ç”¨"),a("code",[e._v("toHaveBeenCalled")]),e._v("åŒ¹é…å™¨æ¥æ£€æµ‹"),a("code",[e._v("spy")]),e._v("æ˜¯å¦è¢«è°ƒç”¨ï¼Œæ›´è¿›ä¸€æ­¥åœ°å¯ä»¥ä½¿ç”¨"),a("code",[e._v("toHaveBeenCalledWith")]),e._v("åŒ¹é…å™¨æµ‹è¯•"),a("code",[e._v("spy")]),e._v("æ˜¯å¦å¸¦æœ‰æŒ‡å®šå‚æ•°è¢«è°ƒç”¨ã€‚")]),e._v(" "),a("p",[e._v("æ‰€ä»¥åœ¨æµ‹è¯•ä¸­ï¼Œéœ€è¦å¾—åˆ°"),a("code",[e._v("setTimeout")]),e._v("çš„è¿”å›å€¼ï¼Œ"),a("code",[e._v("Jest.mockReturnValue")]),e._v("å¯ä»¥å®ç°è¿™ä¸ªéœ€æ±‚ã€‚"),a("code",[e._v("mockReturnValue")]),e._v("å¯ä»¥å°†"),a("code",[e._v("setTimeout")]),e._v("çš„è¿”å›å€¼è®¾ç½®ä¸ºä»»ä½•å€¼ï¼Œæ¯”å¦‚å°†è¿”å›å€¼è®¾ç½®ä¸º123ï¼š"),a("code",[e._v("setTimeOut.mockReturnValue(123)")]),a("br"),e._v("\næµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹ï¼š")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("it('when handleCheck is clicked and the number of alarm exceeds 1 , The previous alarm disappears immediately', () => {\n    // ç›‘å¬clearTimeout\n    jest.spyOn(window, 'clearTimeout')\n    const wrapper = shallowMount(Home, {\n      mocks: {\n        $alarm: () => {}\n      }\n    });\n    // è®¾ç½®setTimeoutè¿”å›å€¼ä¸º123\n    setTimeout.mockReturnValue(123)\n    wrapper.vm.handleCheck();\n    // è®¾ç½®setTimeoutè¿”å›å€¼ä¸º456\n    setTimeout.mockReturnValue(456)\n    wrapper.vm.handleCheck();\n    expect(window.clearTimeout).toHaveBeenCalledWith(123)\n  })\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br")])]),a("h3",{attrs:{id:"æµ‹è¯•æ¨¡æ‹Ÿhttpè¯·æ±‚"}},[e._v("æµ‹è¯•æ¨¡æ‹ŸHTTPè¯·æ±‚")]),e._v(" "),a("p",[a("code",[e._v("HTTP")]),e._v("è¯·æ±‚ä¸åœ¨å•å…ƒæµ‹è¯•èŒƒå›´ï¼Œå› ä¸ºå®ƒä¼šé™ä½å•å…ƒæµ‹è¯•çš„é€Ÿåº¦ï¼›é™ä½å•å…ƒæµ‹è¯•çš„å¯é æ€§ï¼Œå› ä¸º"),a("code",[e._v("HTTP")]),e._v("è¯·æ±‚ä¸ä¼š100%è¯·æ±‚æˆåŠŸã€‚æ‰€ä»¥éœ€è¦åœ¨å•å…ƒæµ‹è¯•ä¸­æ¨¡æ‹Ÿ"),a("code",[e._v("api")]),e._v("æ–‡ä»¶ï¼Œä»è€Œä½¿å¾—"),a("code",[e._v("fetchAlarmDetail")]),e._v("æ°¸è¿œä¸ä¼šå‘é€ä¸€ä¸ª"),a("code",[e._v("HTTP")]),e._v("è¯·æ±‚ã€‚")]),e._v(" "),a("p",[a("code",[e._v("Jest")]),e._v("æä¾›äº†ä¸€ä¸ª"),a("code",[e._v("API")]),e._v("ï¼Œç”¨äºé€‰æ‹©å½“ä¸€ä¸ªæ¨¡å—å¯¼å…¥å¦ä¸€ä¸ªæ¨¡å—æ—¶è¿”å›å“ªäº›æ–‡ä»¶æˆ–å‡½æ•°ã€‚é¦–å…ˆçš„åˆ›å»ºä¸€ä¸ª"),a("code",[e._v("mock")]),e._v("æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨æµ‹è¯•ä¸­å¼•å…¥çœŸæ­£çš„æ–‡ä»¶ã€‚")]),e._v(" "),a("p",[e._v("åœ¨"),a("code",[e._v("api")]),e._v("ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª"),a("code",[e._v("__mocks__")]),e._v("ç›®å½•ï¼Œé‡Œé¢åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿçš„éœ€è¦æµ‹è¯•çš„"),a("code",[e._v("alarmApi")]),e._v("æ–‡ä»¶")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// src/api/__mocks__/alarmApi.js\nexport const fetchAlarmDetail = jest.fn(() => Promise.resolve('äººæœº'));\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("ç„¶ååœ¨æµ‹è¯•æ–‡ä»¶ä¸­åŠ å…¥")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// alarm.spec.js\njest.mock('../../src/api/alarmApi.js');\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("è°ƒç”¨"),a("code",[e._v("jest.mock('../../src/api/alarmApi.js')")]),e._v("åï¼Œå½“æ¨¡å—å¯¼å…¥äº†"),a("code",[e._v("src/api/alarmApi.js")]),e._v("åï¼Œ"),a("code",[e._v("Jest")]),e._v("å°†ä½¿ç”¨åˆ›å»ºçš„"),a("code",[e._v("mock")]),e._v("æ–‡ä»¶è€Œä¸æ˜¯åŸæ–‡ä»¶ã€‚")]),e._v(" "),a("p",[e._v("æµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹ï¼š")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("it('fetch the alarm detail by http', async () => {\n  // è®¾ç½®æ–­è¨€æ•°é‡ï¼Œå¦‚æœä¸€ä¸ªpromiseè¢«æ‹’ç»ï¼Œæµ‹è¯•ä¼šå¤±è´¥\n  expect.assertions(1);\n  const name = await alarmApi.fetchAlarmDetail();\n  expect(name).toBe('äººæœº')\n})\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br")])]),a("p",[e._v("è®¾ç½®æ–­è¨€æ•°é‡æ˜¯åœ¨å¼‚æ­¥æµ‹è¯•ä¸­éå¸¸å¸¸ç”¨çš„æ–¹æ³•ï¼Œå› ä¸ºè¿™å¯ä»¥ç¡®ä¿åœ¨æµ‹è¯•ç»“æŸå‰æ‰§è¡Œå®Œæ‰€æœ‰æ–­è¨€ã€‚")]),e._v(" "),a("h4",{attrs:{id:"åœ¨ç»„ä»¶ä¸­è°ƒç”¨httpè¯·æ±‚å‡½æ•°"}},[e._v("åœ¨ç»„ä»¶ä¸­è°ƒç”¨HTTPè¯·æ±‚å‡½æ•°")]),e._v(" "),a("p",[e._v("ä¸€èˆ¬æ¥è¯´ï¼Œ"),a("code",[e._v("HTTP")]),e._v("è¯·æ±‚æ˜¯åœ¨ç»„ä»¶ä¸­ä½¿ç”¨çš„ï¼Œå•ç‹¬æµ‹è¯•ä½œç”¨å¹¶ä¸å¤§ã€‚é‚£ä¹ˆåœ¨ç»„ä»¶ä¸­è½½å…¥å…¶ä»–å¼‚æ­¥ä¾èµ–ï¼Œåº”è¯¥æ€ä¹ˆå»æµ‹è¯•å‘¢ï¼Ÿ")]),e._v(" "),a("p",[e._v("é¦–å…ˆåœ¨"),a("code",[e._v("home.vue")]),e._v("ä¸­å¯¼å…¥è¯·æ±‚æ–‡ä»¶")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("import * as alarmApi from '@/api/alarmApi.js';\n\n// åœ¨handleCheckä¸­ä½¿ç”¨\nasync handleCheck () {\n    // ...\n    const name = await alarmApi.fetchAlarmDetail();\n    // ...\n}\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br")])]),a("p",[e._v("å½“æµ‹è¯•è°ƒç”¨å¼‚æ­¥ä»£ç çš„æ—¶å€™ï¼Œå¹¶ä¸æ€»æ˜¯å¯ä»¥è®¿é—®éœ€è¦ç­‰å¾…çš„å¼‚æ­¥å‡½æ•°ã€‚è¿™æ„å‘³ç€ä¸èƒ½åœ¨æµ‹è¯•ä¸­ä½¿ç”¨"),a("code",[e._v("await")]),e._v("æ¥ç­‰å¾…å¼‚æ­¥å‡½æ•°ç»“æŸã€‚")]),e._v(" "),a("p",[e._v("è¿™æ—¶å¯ä»¥ä½¿ç”¨"),a("code",[e._v("flush-promises")]),e._v("åº“æ¥å¸®å¿™ï¼Œå®ƒèƒ½ç­‰å¾…å¼‚æ­¥å‡½æ•°ç»“æŸã€‚ä¾‹å¦‚ï¼š")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("let loading = true;\nPromise.resolve().then(() => {\n    loading = false;\n}\nawait flushPromise();\nexpect(loading).toBe(false)\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br")])]),a("p",[e._v("åŸºäºæ­¤ï¼Œå°†ä¹‹å‰çš„æµ‹è¯•ç”¨ä¾‹ä¿®æ”¹ä¸ºï¼š")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// 2.1\n  it('when handleCheck is clicked, show the alarm', async () => {\n    expect.assertions(1);\n    const wrapper = shallowMount(Home, {\n      mocks\n    });\n    const count = wrapper.vm.primaryId;\n    alarmApi.fetchAlarmDetail.mockImplementationOnce(() => Promise.resolve('äººæœº'));\n    wrapper.vm.handleCheck();\n    await flushPromises();\n    const newCount = wrapper.vm.primaryId;\n    expect(newCount).toBe(count + 1)\n  })\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br")])]),a("p",[e._v("åŠ å…¥ä¸€ä¸ª"),a("code",[e._v("expect.assertions(1)")]),e._v("è®¾ç½®æ–­è¨€æ•°é‡ï¼Œè®¾ç½®"),a("code",[e._v("fetchAlarmDetail")]),e._v("å‡½æ•°çš„è¿”å›ç»“æœï¼Œæœ€åè°ƒç”¨"),a("code",[e._v("await flushPromises();")]),e._v("ç­‰å¾…æ‰€æœ‰å¼‚æ­¥å‡½æ•°ç»“æŸã€‚ï¼ˆä¹‹åçš„æµ‹è¯•ç”¨ä¾‹ä¿®æ”¹ï¼Œä¸å†å±•å¼€è®¨è®ºï¼Œè¯¦æƒ…è¯·çœ‹ä»£ç ã€‚ï¼‰")]),e._v(" "),a("p",[e._v("åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥"),a("code",[e._v("yarn test:uni")]),e._v(" "),a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cff34a12d99e428c9bb1d62160e7ea63~tplv-k3u1fbpfcp-watermark.image",alt:""}})]),e._v(" "),a("h3",{attrs:{id:"æµ‹è¯•äº‹ä»¶"}},[e._v("æµ‹è¯•äº‹ä»¶")]),e._v(" "),a("h4",{attrs:{id:"æµ‹è¯•domäº‹ä»¶"}},[e._v("æµ‹è¯•DOMäº‹ä»¶")]),e._v(" "),a("p",[e._v("åŠŸèƒ½ï¼šç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼Œè§¦å‘ä¸€ä¸ª"),a("code",[e._v("click")]),e._v("äº‹ä»¶\næµ‹è¯•ç”¨ä¾‹ï¼š")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("it('click the button then the $alarm will be called', () => {\n  const wrapper = shallowMount(Home, {\n    mocks\n  });\n  wrapper.find('button.check').trigger('click');\n  expect($alarm).toHaveBeenCalled();\n})\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br")])]),a("p",[e._v("æ¯ä¸ªåŒ…è£…å™¨éƒ½æœ‰ä¸€ä¸ª"),a("code",[e._v("trigger")]),e._v("æ–¹æ³•ï¼Œç”¨äºåœ¨åŒ…è£…å™¨ä¸Šåˆ†å‘ä¸€ä¸ªäº‹ä»¶ã€‚")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// é”®ç›˜äº‹ä»¶\nwrapper.trigger('keydown.up')ï¼›\nwrapper.trigger('keydown', {\n  key: 'a'\n})\n// é¼ æ ‡äº‹ä»¶\nwrapper.trigger('mouseenter')ï¼›\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br")])]),a("h4",{attrs:{id:"æµ‹è¯•è‡ªå®šä¹‰äº‹ä»¶"}},[e._v("æµ‹è¯•è‡ªå®šä¹‰äº‹ä»¶")]),e._v(" "),a("p",[a("code",[e._v("VUE")]),e._v("è‡ªå®šä¹‰äº‹ä»¶æ˜¯ç”±å¸¦æœ‰"),a("code",[e._v("VUE")]),e._v("å®ä¾‹"),a("code",[e._v("$emit")]),e._v("æ–¹æ³•çš„ç»„ä»¶äº‹ä»¶å‘å°„å‡ºå»çš„ã€‚åœ¨å­ç»„ä»¶ä¸­å‘å°„ä¸€ä¸ªäº‹ä»¶ï¼š")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// son.vue\nthis.$emit('eventName', payload);\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("åœ¨çˆ¶ç»„ä»¶ä¸­æ¥æ”¶ä¸€ä¸ªäº‹ä»¶ï¼š")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// father\n<son @eventName='handleEvent'></son>\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("åŠŸèƒ½ï¼š ç‚¹å‡»ä½äº"),a("code",[e._v("HelloWorld")]),e._v("ç»„ä»¶çš„"),a("code",[e._v("class")]),e._v("ä¸º"),a("code",[e._v("hello")]),e._v("çš„"),a("code",[e._v("button")]),e._v("å…ƒç´ ï¼Œè§¦å‘"),a("code",[e._v("sayHello")]),e._v("äº‹ä»¶å¹¶æºå¸¦"),a("code",[e._v("hello")]),e._v("ã€‚ä½äº"),a("code",[e._v("Home")]),e._v("ç»„ä»¶çš„"),a("code",[e._v("handleSayHello")]),e._v("è§¦å‘ï¼Œå°†"),a("code",[e._v("greeting")]),e._v("ä»"),a("code",[e._v("hi")]),e._v("å˜æˆ"),a("code",[e._v("hello")]),e._v("ã€‚")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("it('click the check button, home.greeting will change to hello', () => {\n    const wrapper = shallowMount(Home);\n    wrapper.findComponent(Hello).vm.$emit('sayHello', 'hello');\n    expect(wrapper.vm.greeting).toBe('hello')\n  })\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])])])}),[],!1,null,null,null);s.default=t.exports}}]);
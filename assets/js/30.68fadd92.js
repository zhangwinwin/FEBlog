(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{466:function(o,a,r){"use strict";r.r(a);var t=r(57),n=Object(t.a)({},(function(){var o=this,a=o.$createElement,r=o._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":o.$parent.slotKey}},[r("section",{staticStyle:{"font-size":"16px",padding:"0 10px","word-spacing":"0px","word-break":"break-word","word-wrap":"break-word","text-align":"left","margin-top":"-10px","line-height":"1.75",color:"#595959","font-family":"Optima-Regular, Optima, PingFangTC-Light, PingFangSC-light, PingFangTC-light","letter-spacing":"2px","background-image":"linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%)","background-size":"20px 20px","background-position":"center center"},attrs:{id:"nice","data-tool":"mdnice编辑器","data-website":"https://www.mdnice.com"}},[r("blockquote",{staticStyle:{display:"block","font-size":"0.9em",overflow:"auto","overflow-scrolling":"touch","padding-top":"10px","padding-bottom":"10px","padding-left":"20px","padding-right":"10px","margin-bottom":"20px","margin-top":"20px","text-size-adjust":"100%","line-height":"1.55em","font-weight":"400","border-radius":"6px",color:"#595959","font-style":"normal","text-align":"left","box-sizing":"inherit","border-left":"none",border:"1px solid #DEC6FB",background:"#F6EEFF"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{color:"#DEC6FB","font-size":"34px","line-height":"1","font-weight":"700"}},[o._v("❝")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px",margin:"0px","line-height":"26px",color:"#595959"}},[o._v("    古人云：知其然知其所以然")]),r("span",{staticStyle:{color:"#DEC6FB","font-size":"34px","line-height":"1","font-weight":"700",float:"right"}},[o._v("❞")])]),o._v(" "),r("h2",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px","font-weight":"bold",color:"black","font-size":"22px","text-align":"left",margin:"20px 10px 0px 0px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticClass:"prefix",staticStyle:{display:"none"}}),r("span",{staticClass:"content",staticStyle:{"font-size":"18px","font-weight":"bold",display:"inline-block","padding-left":"10px","border-left":"5px solid #DEC6FB",color:"#595959"}},[o._v("前言")]),r("span",{staticClass:"suffix"})]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("相信有很多开发第一次碰到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("vue")]),o._v("中的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick()")]),o._v("时都会把它当作一次"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setTimeout()")]),o._v("调用。这个理解是对的吗？")]),o._v(" "),r("h3",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px",color:"black","font-size":"16px","font-weight":"bold","text-align":"center"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticClass:"prefix",staticStyle:{display:"none"}}),r("span",{staticClass:"content",staticStyle:{"border-bottom":"2px solid #DEC6FB",color:"#595959"}},[o._v("1. 前置知识")]),r("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("这个方法理解起来并不难，但需要知道下面的概念：")]),o._v(" "),r("ul",{staticStyle:{"margin-top":"8px","margin-bottom":"8px","padding-left":"25px","font-size":"15px",color:"#595959","list-style-type":"circle"},attrs:{"data-tool":"mdnice编辑器"}},[r("li",[r("section",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","line-height":"26px","text-align":"left","font-size":"14px","font-weight":"normal",color:"#595959"}},[o._v("调用栈")])]),r("li",[r("section",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","line-height":"26px","text-align":"left","font-size":"14px","font-weight":"normal",color:"#595959"}},[o._v("任务队列")])]),r("li",[r("section",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","line-height":"26px","text-align":"left","font-size":"14px","font-weight":"normal",color:"#595959"}},[o._v("事件循环")])])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("下面假设大家对这些概念已经非常清楚了。")]),o._v(" "),r("h2",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px","font-weight":"bold",color:"black","font-size":"22px","text-align":"left",margin:"20px 10px 0px 0px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticClass:"prefix",staticStyle:{display:"none"}}),r("span",{staticClass:"content",staticStyle:{"font-size":"18px","font-weight":"bold",display:"inline-block","padding-left":"10px","border-left":"5px solid #DEC6FB",color:"#595959"}},[o._v("$nextTick()")]),r("span",{staticClass:"suffix"})]),o._v(" "),r("h3",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px",color:"black","font-size":"16px","font-weight":"bold","text-align":"center"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticClass:"prefix",staticStyle:{display:"none"}}),r("span",{staticClass:"content",staticStyle:{"border-bottom":"2px solid #DEC6FB",color:"#595959"}},[o._v("1. 概念")]),r("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("掌握一个知识点的背后原理，就必须对它的使用要非常熟悉。来看官方的介绍。")]),o._v(" "),r("blockquote",{staticStyle:{display:"block","font-size":"0.9em",overflow:"auto","overflow-scrolling":"touch","padding-top":"10px","padding-bottom":"10px","padding-left":"20px","padding-right":"10px","margin-bottom":"20px","margin-top":"20px","text-size-adjust":"100%","line-height":"1.55em","font-weight":"400","border-radius":"6px",color:"#595959","font-style":"normal","text-align":"left","box-sizing":"inherit","border-left":"none",border:"1px solid #DEC6FB",background:"#F6EEFF"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{color:"#DEC6FB","font-size":"34px","line-height":"1","font-weight":"700"}},[o._v("❝")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px",margin:"0px","line-height":"26px",color:"#595959"}},[o._v("vm.$nextTick([callback])")]),o._v(" "),r("ul",{staticStyle:{"margin-top":"8px","margin-bottom":"8px","padding-left":"25px","font-size":"15px",color:"#595959","list-style-type":"circle"}},[r("li",[r("section",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","line-height":"26px","text-align":"left","font-size":"14px","font-weight":"normal",color:"#595959"}},[o._v("参数：{function} [callback]")])]),r("li",[r("section",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","line-height":"26px","text-align":"left","font-size":"14px","font-weight":"normal",color:"#595959"}},[o._v("用法：将回调延迟到下次"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("更新循环之后执行。在修改数据之后立即使用它，然后等待"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("更新。回调的this自动绑定到调用它的实例上。")])])]),o._v(" "),r("span",{staticStyle:{float:"right",color:"#DEC6FB"}},[o._v("❞")])]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[o._v("new Vue({\n"),r("span"),o._v("  // ...\n"),r("span"),o._v("  methods: {\n"),r("span"),o._v("    // ...\n"),r("span"),o._v("    example: "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("function")])]),o._v(" () {\n"),r("span"),o._v("      // 修改数据\n"),r("span"),o._v("      this.message = "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'changed'")]),o._v("\n"),r("span"),o._v("      // DOM 还没有更新\n"),r("span"),o._v("      this."),r("span",{staticClass:"hljs-variable",staticStyle:{color:"#BD63C5","line-height":"26px"}},[o._v("$nextTick")]),o._v("("),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("function")])]),o._v(" () {\n"),r("span"),o._v("        // DOM 现在更新了\n"),r("span"),o._v("        // `this` 绑定到当前实例\n"),r("span"),o._v("        this.doSomethingElse()\n"),r("span"),o._v("      })\n"),r("span"),o._v("    }\n"),r("span"),o._v("  }\n"),r("span"),o._v("})\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v('上面有一句话说"'),r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("将回调延迟到下次"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("更新循环之后在执行"),r("span",[o._v("」")])]),o._v('"。这句话的意思是：')]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Vue")]),o._v("在更新"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("时是异步执行的。只要侦听到数据变化，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Vue")]),o._v("将开启一个队列，并缓冲在同一事件循环中发生的所有数据变更。如果同一个"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("watcher")]),o._v("被多次触发，只会被推入到队列中一次。然后，在下一个的事件循环中，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Vue")]),o._v("刷新队列并执行实际的工作。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("例如，当设置"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("vm.someData = 'new value'")]),o._v("，该组件不会立即重新渲染。当刷新队列时，组件会在下一个事件循环中更新。但是如果想基于更新后的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("状态来做点什么，这就有点难办了。所以Vue就推出了"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick()")]),o._v("，此方法接收的回调函数将在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("更新完成后被调用。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Vue")]),o._v("文档上也写了：")]),o._v(" "),r("blockquote",{staticStyle:{display:"block","font-size":"0.9em",overflow:"auto","overflow-scrolling":"touch","padding-top":"10px","padding-bottom":"10px","padding-left":"20px","padding-right":"10px","margin-bottom":"20px","margin-top":"20px","text-size-adjust":"100%","line-height":"1.55em","font-weight":"400","border-radius":"6px",color:"#595959","font-style":"normal","text-align":"left","box-sizing":"inherit","border-left":"none",border:"1px solid #DEC6FB",background:"#F6EEFF"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{color:"#DEC6FB","font-size":"34px","line-height":"1","font-weight":"700"}},[o._v("❝")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px",margin:"0px","line-height":"26px",color:"#595959"}},[r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Vue")]),o._v("在内部对异步队列尝试使用原生的 "),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Promise.then")]),o._v("、"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("MutationObserver")]),o._v(" 和 "),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setImmediate")]),o._v("，如果执行环境不支持，则会采用 "),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setTimeout(fn, 0)")]),o._v(" 代替。")]),o._v(" "),r("span",{staticStyle:{float:"right",color:"#DEC6FB"}},[o._v("❞")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("所以将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick()")]),o._v("当作一次"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setTimeout()")]),o._v("调用，并不能说是错的。只是没有那么准确。")]),o._v(" "),r("h3",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px",color:"black","font-size":"16px","font-weight":"bold","text-align":"center"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticClass:"prefix",staticStyle:{display:"none"}}),r("span",{staticClass:"content",staticStyle:{"border-bottom":"2px solid #DEC6FB",color:"#595959"}},[o._v("2. 源码解读")]),r("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick()")]),o._v("是在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("/src/core/instance/render.js")]),o._v("中定义的：")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-built_in",staticStyle:{color:"#4EC9B0","line-height":"26px"}},[o._v("export")]),o._v(" "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("function")]),o._v(" renderMixin (Vue: Class<Component>) {\n"),r("span"),o._v("  ...\n"),r("span"),o._v("  Vue.prototype."),r("span",{staticClass:"hljs-variable",staticStyle:{color:"#BD63C5","line-height":"26px"}},[o._v("$nextTick")]),o._v(" = "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("function")]),o._v(" (fn: Function) {\n"),r("span"),o._v("    "),r("span",{staticClass:"hljs-built_in",staticStyle:{color:"#4EC9B0","line-height":"26px"}},[o._v("return")]),o._v(" nextTick(fn, this)\n"),r("span"),o._v("  }\n"),r("span"),o._v("  ...\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick()")]),o._v("方法是在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("renderMixin")]),o._v("函数中挂载到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Vue")]),o._v("原型上的。可以看出"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick()")]),o._v("是对"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("nextTick")]),o._v("函数的简单封装。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("而"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("nextTick")]),o._v("函数是在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("/src/core/util/next-tick.js")]),o._v("中定义的。"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("next-tick.js")]),o._v("文件中主体是一段4层"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("if else")]),o._v("语句。")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("if")])]),o._v(" () {\n"),r("span"),o._v("    ...\n"),r("span"),o._v("} "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("if")])]),o._v(" () {\n"),r("span"),o._v("    ...\n"),r("span"),o._v("} "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("if")])]),o._v(" () {\n"),r("span"),o._v("    ...\n"),r("span"),o._v("} "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" {\n"),r("span"),o._v("    ...\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("第一层"),r("span",[o._v("」")])])]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (typeof Promise !== "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'undefined'")]),o._v(" && isNative(Promise)) {\n"),r("span"),o._v("  const p = Promise.resolve()\n"),r("span"),o._v("  timerFunc = () => {\n"),r("span"),o._v("    p.then(flushCallbacks)\n"),r("span"),o._v("    // In problematic UIWebViews, Promise.then doesn"),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'t completely break, but\n"),r("span"),o._v("    // it can get stuck in a weird state where callbacks are pushed into the\n"),r("span"),o._v("    // microtask queue but the queue isn'")]),o._v("t being flushed, until the browser\n"),r("span"),o._v("    // needs to "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("do")]),o._v(" some other work, e.g. handle a timer. Therefore we can\n"),r("span"),o._v("    // "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v('"force"')]),o._v(" the microtask queue to be flushed by adding an empty timer.\n"),r("span"),o._v("    "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (isIOS) setTimeout(noop)\n"),r("span"),o._v("  }\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("首先判断当前环境支不支持"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Promise")]),o._v("，如果支持则优先使用"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Promise")]),o._v("。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("总所周知，任务队列并非只有一个队列，总的来说可以将其分为微任务--"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("microtask")]),o._v("和宏任务--"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("macrotask")]),o._v("。当调用栈空闲后，事件循环就会在宏任务消息队列中读取一个任务并执行。宏任务执行的过程中，有时候会产生多个微任务，将其保存在微任务队列中。也就是说每个宏任务都关联了一个微任务队列。当主函数执行结束之后、当前宏任务结束之前，事件循环就会将当前微任务队列执行并清空。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("另外两个宏任务之间可能穿插着"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("UI")]),o._v("的重渲染，那么只需要在微任务中把所有"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("UI")]),o._v("重渲染之前把需要更新的数据全部更新，这样只需要一次重渲染就能得到最新的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("了。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("对于"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("vue")]),o._v("来说，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("vue")]),o._v("是一个数据驱动的框架，要是能在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("UI")]),o._v("重渲染之前更新所有数据状态，这对性能的提升是一个非常大的帮助，所以要优先使用微任务去更新数据状态而不是宏任务，这就是为什么优先使用"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("promise")]),o._v("，而不是"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setTimeout")]),o._v("的原因。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("接着解读："),r("span",[o._v("」")])]),r("br"),o._v("\n首先定义常量 "),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("p")]),o._v(" 它的值是一个立即 "),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("resolve")]),o._v(" 的 "),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Promise")]),o._v(" 实例对象。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("接着将变量 "),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("timerFunc")]),o._v(" 定义为一个函数，这个函数的执行将会把 "),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v(" 函数注册为微任务。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("接着"),r("span",[o._v("」")])])]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[o._v("// In problematic UIWebViews, Promise.then doesn"),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'t completely break, but\n"),r("span"),o._v("// it can get stuck in a weird state where callbacks are pushed into the\n"),r("span"),o._v("// microtask queue but the queue isn'")]),o._v("t being flushed, until the browser\n"),r("span"),o._v("// needs to "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("do")]),o._v(" some other work, e.g. handle a timer. Therefore we can\n"),r("span"),o._v("// "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v('"force"')]),o._v(" the microtask queue to be flushed by adding an empty timer.\n"),r("span"),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (isIOS) setTimeout(noop)\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("注释说，在一些"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("UIWebViews")]),o._v("中微任务没有被刷新，解决方案就是让浏览器做一些其他的事件，比如注册一个宏任务，即使这个宏任务什么都不做，这样就能间接触发微任务的刷新。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("第二层"),r("span",[o._v("」")])])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("如果当前环境不支持"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Promise")]),o._v("（IE：看我干嘛），走到第二层"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("else if")]),o._v("语句中。")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (!isIE && typeof MutationObserver !== "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'undefined'")]),o._v(" && (\n"),r("span"),o._v("  isNative(MutationObserver) ||\n"),r("span"),o._v("  // PhantomJS and iOS 7.x\n"),r("span"),o._v("  MutationObserver.toString() === "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'[object MutationObserverConstructor]'")]),o._v("\n"),r("span"),o._v(")) {\n"),r("span"),o._v("  // Use MutationObserver "),r("span",{staticClass:"hljs-built_in",staticStyle:{color:"#4EC9B0","line-height":"26px"}},[o._v("where")]),o._v(" native Promise is not available,\n"),r("span"),o._v("  // e.g. PhantomJS, iOS7, Android 4.4\n"),r("span"),o._v("  // ("),r("span",{staticClass:"hljs-comment",staticStyle:{color:"#57A64A","font-style":"italic","line-height":"26px"}},[o._v("#6466 MutationObserver is unreliable in IE11)")]),o._v("\n"),r("span"),o._v("  "),r("span",{staticClass:"hljs-built_in",staticStyle:{color:"#4EC9B0","line-height":"26px"}},[o._v("let")]),o._v(" counter = 1\n"),r("span"),o._v("  const observer = new MutationObserver(flushCallbacks)\n"),r("span"),o._v("  const textNode = document.createTextNode(String(counter))\n"),r("span"),o._v("  observer.observe(textNode, {\n"),r("span"),o._v("    characterData: "),r("span",{staticClass:"hljs-literal",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("true")]),o._v("\n"),r("span"),o._v("  })\n"),r("span"),o._v("  timerFunc = () => {\n"),r("span"),o._v("    counter = (counter + 1) % 2\n"),r("span"),o._v("    textNode.data = String(counter)\n"),r("span"),o._v("  }\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("判断当前环境是否支持"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("MutationObserver")]),o._v("。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("MutationObserver")]),o._v("也是一个微任务，提供了监视对"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("树所做更改的能力。它被设计为旧的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Mutation Events")]),o._v("功能的替代品，该功能是"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM3 Events")]),o._v("规范的一部分。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("首先将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("传入"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("MutationObserver")]),o._v("构造函数中，创建并返回一个新的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("MutationObserver")]),o._v("它会在指定的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("发生变化时被调用。")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[o._v("const observer = new MutationObserver(flushCallbacks)\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("然后创建一个根据"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("counter")]),o._v("变量的文本"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("节点，并配置"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("MutationObserver")]),o._v("订阅此"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("节点，所以当这个"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("节点变化时，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("就会注册在微任务队列。")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-built_in",staticStyle:{color:"#4EC9B0","line-height":"26px"}},[o._v("let")]),o._v(" counter = 1\n"),r("span"),o._v("const textNode = document.createTextNode(String(counter))\n"),r("span"),o._v("observer.observe(textNode, {\n"),r("span"),o._v("    characterData: "),r("span",{staticClass:"hljs-literal",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("true")]),o._v("\n"),r("span"),o._v("})\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("最后将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("timeFun")]),o._v("注册为一个函数，当"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("timeFun")]),o._v("执行时，立即更改"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("counter")]),o._v("的值，从而引起"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("MutationObserver")]),o._v("的更改，将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("注册在微任务队列中。")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[o._v("timerFunc = () => {\n"),r("span"),o._v("    counter = (counter + 1) % 2\n"),r("span"),o._v("    textNode.data = String(counter)\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("第三层"),r("span",[o._v("」")])])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("接着解读第三层"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("else if")]),o._v("语句")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (typeof setImmediate !== "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'undefined'")]),o._v(" && isNative(setImmediate)) {\n"),r("span"),o._v("  // Fallback to setImmediate.\n"),r("span"),o._v("  // Techinically it leverages the (macro) task queue,\n"),r("span"),o._v("  // but it is still a better choice than setTimeout.\n"),r("span"),o._v("  timerFunc = () => {\n"),r("span"),o._v("    setImmediate(flushCallbacks)\n"),r("span"),o._v("  }\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("可以看出"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setImmediate")]),o._v("函数优先"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setTimeout")]),o._v("函数。这是因为"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setImmediate")]),o._v("比"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setTimeout")]),o._v("有更好的性能。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setTimeout")]),o._v("将回调函数注册在宏任务队列中之前要不断的做超时检测，而"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setImmediate")]),o._v("不需要。但是"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setImmediate")]),o._v("有明显的缺陷，只有"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("IE")]),o._v("实现了它。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("第四层"),r("span",[o._v("」")])])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("最后第四层"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("else")]),o._v("语句，就轮到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setTimeout")]),o._v("出场了。")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" {\n"),r("span"),o._v("  // Fallback to setTimeout.\n"),r("span"),o._v("  timerFunc = () => {\n"),r("span"),o._v("    setTimeout(flushCallbacks, 0)\n"),r("span"),o._v("  }\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("h3",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px",color:"black","font-size":"16px","font-weight":"bold","text-align":"center"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticClass:"prefix",staticStyle:{display:"none"}}),r("span",{staticClass:"content",staticStyle:{"border-bottom":"2px solid #DEC6FB",color:"#595959"}},[o._v("3. 非浏览器环境")]),r("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("翻查源码的过程中，发现"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("nextTick")]),o._v("函数的定义不只有一处地方。在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("packages/weex-vue-framework/factory.js")]),o._v("中也定义了。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("也不难理解，因为上面介绍的都是基于是浏览器环境的，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("weex")]),o._v("是运行在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("node")]),o._v("环境下的。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("也来看看这个"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("nextTick")]),o._v("定义与上面的有什么不同。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("主体是围绕着"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("mircotask")]),o._v("与"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("marcotask")]),o._v("进行，也就是分别定义宏任务与微任务。")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[o._v("var macroTimerFunc;\n"),r("span"),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("if")])]),o._v(" () {\n"),r("span"),o._v("    macroTimerFunc = "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("function")])]),o._v(" () {...}\n"),r("span"),o._v("} "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("if")])]),o._v(" () {\n"),r("span"),o._v("    macroTimerFunc = "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("function")])]),o._v(" () {...}\n"),r("span"),o._v("} "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" {...}\n"),r("span"),o._v("\n"),r("span"),o._v("var microTimerFunc;\n"),r("span"),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("if")])]),o._v(" () {\n"),r("span"),o._v("    microTimerFunc = "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("function")])]),o._v(" () {...}\n"),r("span"),o._v("} "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" {\n"),r("span"),o._v("    microTimerFunc = macroTimerFunc\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("可以看到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("macroTimerFunc")]),o._v("有三层"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("if")]),o._v("判断"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("，microTimerFunc")]),o._v("有两层。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("macroTimerFunc"),r("span",[o._v("」")])])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("先看"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("macroTimerFunc")])]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (typeof setImmediate !== "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'undefined'")]),o._v(" && isNative(setImmediate)) {\n"),r("span"),o._v("  macroTimerFunc = "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("function")])]),o._v(" () {\n"),r("span"),o._v("    setImmediate(flushCallbacks);\n"),r("span"),o._v("  };\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("优先判断当前环境是否支持"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setImmediate")]),o._v("，最后的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("else")]),o._v("才是使用"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setTimeout")]),o._v("。")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" {\n"),r("span"),o._v("  /* istanbul ignore next */\n"),r("span"),o._v("  macroTimerFunc = "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("function")])]),o._v(" () {\n"),r("span"),o._v("    setTimeout(flushCallbacks, 0);\n"),r("span"),o._v("  };\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("MessageChannel"),r("span",[o._v("」")])])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("而中间的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("else if")]),o._v("是判断是否支持"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("MessageChannel")])]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (typeof MessageChannel !== "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'undefined'")]),o._v(" && (\n"),r("span"),o._v("  isNative(MessageChannel) ||\n"),r("span"),o._v("  // PhantomJS\n"),r("span"),o._v("  MessageChannel.toString() === "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'[object MessageChannelConstructor]'")]),o._v("\n"),r("span"),o._v(")) {\n"),r("span"),o._v("  var channel = new MessageChannel();\n"),r("span"),o._v("  var port = channel.port2;\n"),r("span"),o._v("  channel.port1.onmessage = flushCallbacks;\n"),r("span"),o._v("  macroTimerFunc = "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("function")])]),o._v(" () {\n"),r("span"),o._v("    port.postMessage(1);\n"),r("span"),o._v("  };\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("了解过"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Web Workers")]),o._v("都知道，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Web Workers")]),o._v("的内部实现就是用到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("MessageChannel")]),o._v("。一个"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("MessageChannel")]),o._v("实例对象拥有两个属性"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("port1")]),o._v("和"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("port2")]),o._v("，只要让"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("port1")]),o._v("监听"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("onmessage")]),o._v("事件，然后使用"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("port2")]),o._v("的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("postMessage")]),o._v("向"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("port1")]),o._v("发送消息即可，这样"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("port1")]),o._v("的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("onmessage")]),o._v("回调就会被注册为宏任务，由于它也不需要任何检测工作，所以性能也比"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("setTimeout")]),o._v("要好。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("总之"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("macroTimerFunc")]),o._v("函数的作用就是将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("注册为宏任务。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("microTimerFunc"),r("span",[o._v("」")])])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("举一反三，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("microTimerFunc")]),o._v("函数的作用就是将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("注册为微任务。")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (typeof Promise !== "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'undefined'")]),o._v(" && isNative(Promise)) {\n"),r("span"),o._v("  var p = Promise.resolve();\n"),r("span"),o._v("  microTimerFunc = "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("function")])]),o._v(" () {\n"),r("span"),o._v("    p.then(flushCallbacks);\n"),r("span"),o._v("    // "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("in")]),o._v(" problematic UIWebViews, Promise.then doesn"),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'t completely break, but\n"),r("span"),o._v("    // it can get stuck in a weird state where callbacks are pushed into the\n"),r("span"),o._v("    // microtask queue but the queue isn'")]),o._v("t being flushed, until the browser\n"),r("span"),o._v("    // needs to "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("do")]),o._v(" some other work, e.g. handle a timer. Therefore we can\n"),r("span"),o._v("    // "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v('"force"')]),o._v(" the microtask queue to be flushed by adding an empty timer.\n"),r("span"),o._v("    "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (isIOS) { setTimeout(noop); }\n"),r("span"),o._v("  };\n"),r("span"),o._v("} "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" {\n"),r("span"),o._v("  // fallback to macro\n"),r("span"),o._v("  microTimerFunc = macroTimerFunc;\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("如果不支持"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("Promise")]),o._v("，那么"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("microTimerFunc = macroTimerFunc;")]),o._v("。")]),o._v(" "),r("h3",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px",color:"black","font-size":"16px","font-weight":"bold","text-align":"center"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticClass:"prefix",staticStyle:{display:"none"}}),r("span",{staticClass:"content",staticStyle:{"border-bottom":"2px solid #DEC6FB",color:"#595959"}},[o._v("4. nextTick")]),r("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("最后，真正的看一下"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("nextTick")]),o._v("函数的主体")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-built_in",staticStyle:{color:"#4EC9B0","line-height":"26px"}},[o._v("export")]),o._v(" "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("function")]),o._v(" nextTick (cb?: Function, ctx?: Object) {\n"),r("span"),o._v("  "),r("span",{staticClass:"hljs-built_in",staticStyle:{color:"#4EC9B0","line-height":"26px"}},[o._v("let")]),o._v(" _resolve\n"),r("span"),o._v("  callbacks.push(() => {\n"),r("span"),o._v("    "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (cb) {\n"),r("span"),o._v("      try {\n"),r("span"),o._v("        cb.call(ctx)\n"),r("span"),o._v("      } catch (e) {\n"),r("span"),o._v("        handleError(e, ctx, "),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'nextTick'")]),o._v(")\n"),r("span"),o._v("      }\n"),r("span"),o._v("    } "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("else")]),o._v(" "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (_resolve) {\n"),r("span"),o._v("      _resolve(ctx)\n"),r("span"),o._v("    }\n"),r("span"),o._v("  })\n"),r("span"),o._v("  // 忽略\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("nextTick")]),o._v("函数会在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组中添加一个新的函数，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组定义在文件头部："),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("const callback = []")]),o._v("。注意并不是将cb回调函数直接添加到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组中，会使用一个新的函数包裹回调函数并将新函数添加到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组中。但这个被添加到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组中的函数执行会间接调用cd回调函数，并且可以看到cb函数时使用"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v(".call")]),o._v("方法将函数cb的作用域设置为"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("ctx")]),o._v("，也就是"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("nextTick")]),o._v("函数的第二个参数。所以对于"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("方法来讲，传递给"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("方法的回调函数的作用域是当前组件实例对象，前提是回调函数不能是箭头函数，其实在平时的使用中，回调函数使用箭头函数也没关系，只要达到目的就行。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("继续看源码"),r("span",[o._v("」")])])]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-built_in",staticStyle:{color:"#4EC9B0","line-height":"26px"}},[o._v("export")]),o._v(" "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("function")]),o._v(" nextTick (cb?: Function, ctx?: Object) {\n"),r("span"),o._v("  ...\n"),r("span"),o._v("  "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("if")]),o._v(" (!pending) {\n"),r("span"),o._v("    pending = "),r("span",{staticClass:"hljs-literal",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("true")]),o._v("\n"),r("span"),o._v("    timerFunc()\n"),r("span"),o._v("  }\n"),r("span"),o._v("  ...\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("进行一个"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("if")]),o._v("条件判断，判断"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("pending")]),o._v("的真假，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("pending")]),o._v("变量定义在文件头部："),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("let pending = false")]),o._v("，它是一个标识，它的真假代表回调队列是否处于等待刷新的状态，初始值为"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("false")]),o._v("代表回调队列为空不需要等待刷新。假如此时在某个地方调用了"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("方法，那么"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("if")]),o._v("语句块内的代码将会被执行，在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("if")]),o._v("语句块内优先将变量"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("pending")]),o._v("的值设置为"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("true")]),o._v("，代表着此时回调队列不为空，正在等待刷新。既然等待刷新，那么当然要刷新回调队列。这时就用到前面的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("timerFunc")]),o._v("函数。在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("week")]),o._v("中则是"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("micTimeFunc")]),o._v("或者"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("marcoTaskFunc")]),o._v("。无论是哪种任务类型，它们都将会等待调用栈清空之后才执行。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("举例："),r("span",[o._v("」")])])]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("created")])]),o._v(" () {\n"),r("span"),o._v("    this."),r("span",{staticClass:"hljs-variable",staticStyle:{color:"#BD63C5","line-height":"26px"}},[o._v("$nextTick")]),o._v("( () => {console.log(1)})\n"),r("span"),o._v("    this."),r("span",{staticClass:"hljs-variable",staticStyle:{color:"#BD63C5","line-height":"26px"}},[o._v("$nextTick")]),o._v("( () => {console.log(2)})\n"),r("span"),o._v("    this."),r("span",{staticClass:"hljs-variable",staticStyle:{color:"#BD63C5","line-height":"26px"}},[o._v("$nextTick")]),o._v("( () => {console.log(3)})\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("created")]),o._v("钩子函数中连续调用三次"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("方法，但只有第一次调用"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("方法时才会执行"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("timerFunc")]),o._v("函数将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("注册为微任务，但此时"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("函数并不会执行，因为它要等待接下来的两次"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("方法的调用语句执行完后才会执行，准确的说等待调用栈被清空之后才会进行。也就是说"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("函数执行的时候，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("回调队列中将包含本次事件循环所收集的所有通过"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("方法注册的回调，而接下来的任务就是在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("函数内将这些回调全部执行并清空。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("下面是"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("的源码"),r("span",[o._v("」")])])]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("function")]),o._v(" "),r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("flushCallbacks")])]),o._v(" () {\n"),r("span"),o._v("  pending = "),r("span",{staticClass:"hljs-literal",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("false")]),o._v("\n"),r("span"),o._v("  const copies = callbacks.slice(0)\n"),r("span"),o._v("  callbacks.length = 0\n"),r("span"),o._v("  "),r("span",{staticClass:"hljs-keyword",staticStyle:{color:"#569CD6","line-height":"26px"}},[o._v("for")]),o._v(" ("),r("span",{staticClass:"hljs-built_in",staticStyle:{color:"#4EC9B0","line-height":"26px"}},[o._v("let")]),o._v(" i = 0; i < copies.length; i++) {\n"),r("span"),o._v("    copies[i]()\n"),r("span"),o._v("  }\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("首先将变量"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("pending")]),o._v("设置为"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("false")]),o._v("，接着开始执行回调，但需要注意的是在执行"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("队列中的回调函数时并没有直接遍历"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组，而是使用"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("copies")]),o._v("常量保存一份复制品。然后遍历"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("copies")]),o._v("数组，并且在遍历"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("copies")]),o._v("数值之前将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组清空："),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks.length = 0。")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("为什么要这样做呢？"),r("strong",{staticStyle:{color:"#595959","font-weight":"bold"}},[r("span",[o._v("「")]),o._v("举个例子"),r("span",[o._v("」")])])]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[r("span",{staticClass:"hljs-function",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[r("span",{staticClass:"hljs-title",staticStyle:{color:"#DCDCDC","line-height":"26px"}},[o._v("created")])]),o._v(" () {\n"),r("span"),o._v("    this.age = 20\n"),r("span"),o._v("    this."),r("span",{staticClass:"hljs-variable",staticStyle:{color:"#BD63C5","line-height":"26px"}},[o._v("$nextTick")]),o._v("(() => {\n"),r("span"),o._v("        this.age = 21\n"),r("span"),o._v("        this."),r("span",{staticClass:"hljs-variable",staticStyle:{color:"#BD63C5","line-height":"26px"}},[o._v("$nextTick")]),o._v("(() => { console.log("),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'第二个nextTick'")]),o._v(")})\n"),r("span"),o._v("    })\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("在"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick()")]),o._v("的回调函数中再次调用了"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("方法，理论上外层"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("方法的回调函数不应该与内层"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("的回调函数在同一个微任务中被执行，而是两个不同的微任务，虽然在结果上看或许没什么差别，但从设计角度就应该这样做。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("上面代码修改了两次"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("age")]),o._v("属性的值，首先将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("age")]),o._v("的值修改为"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("20")]),o._v("，上面说到Vue在更新"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("DOM")]),o._v("时也是异步执行的，这个过程中就是将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushSchedulerQueue")]),o._v("添加到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组中")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[o._v("callbacks = [\n"),r("span"),o._v("    flushSchedulerQueue\n"),r("span"),o._v("]\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("同时将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("函数注册为微任务，所以微任务队列为")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[o._v("// 微任务队列\n"),r("span"),o._v("[\n"),r("span"),o._v("    flushCallbacks\n"),r("span"),o._v("]\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("接着调用第一个"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("方法，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("会将回调函数添加到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组中，那么此时的"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组如下：")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[o._v("callbacks = [\n"),r("span"),o._v("    flushSchedulerQueue,\n"),r("span"),o._v("    () => {\n"),r("span"),o._v("        this.age = 21\n"),r("span"),o._v("        this."),r("span",{staticClass:"hljs-variable",staticStyle:{color:"#BD63C5","line-height":"26px"}},[o._v("$nextTick")]),o._v("(() => {console.log("),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'第二个$nextTick'")]),o._v(")})\n"),r("span"),o._v("    }\n"),r("span"),o._v("]\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("接下来主线程出于空闲状态，开始执行微任务队列，即执行"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("函数，"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("函数会按照顺序执行"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组中的函数，首先会执行"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushSchedulerQueue")]),o._v("函数，这个函数会遍历"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("queue")]),o._v("中所有观察者并重新求值。接着执行如下函数:")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[o._v("() => {\n"),r("span"),o._v("    this.age = 21\n"),r("span"),o._v("    this."),r("span",{staticClass:"hljs-variable",staticStyle:{color:"#BD63C5","line-height":"26px"}},[o._v("$nextTick")]),o._v("(() => {console.log("),r("span",{staticClass:"hljs-string",staticStyle:{color:"#D69D85","line-height":"26px"}},[o._v("'第二个$nextTick'")]),o._v(")})\n"),r("span"),o._v("}\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("这个函数是第一个"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("$nextTick")]),o._v("的回调函数，由于在执行该回调函数之前已经完成了重新求值，所以该回调函数内的代码是能够访问更新后的值。在该回调函数内再次修改"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("age")]),o._v("属性的值后，同样会调用"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("nextTick")]),o._v("函数将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushSchedulerQueue")]),o._v("添加到"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("callbacks")]),o._v("数组中，但是由于在执行"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("函数时优先将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("pending")]),o._v("的设置为"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("false")]),o._v("，所以"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("nextTick")]),o._v("函数会将"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("函数注册为一个新的微任务。此时目的就达成了，队列包含两个微任务。")]),o._v(" "),r("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[r("span",{staticStyle:{display:"block",background:"url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#1E1E1E","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),r("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#DCDCDC",display:"block","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","padding-top":"15px",background:"#1E1E1E","border-radius":"5px"}},[o._v("// 此时微任务队列\n"),r("span"),o._v("[\n"),r("span"),o._v("    flushCallbacks，\n"),r("span"),o._v("    flushCallbacks\n"),r("span"),o._v("]\n"),r("span")])]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("第二个"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("函数的一切流程与第一个"),r("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",padding:"2px 4px","border-radius":"4px",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#595959"}},[o._v("flushCallbacks")]),o._v("是完全相同的。")]),o._v(" "),r("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#595959",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o._v("以上，$nextTick()就介绍完毕。")])])])}),[],!1,null,null,null);a.default=n.exports}}]);